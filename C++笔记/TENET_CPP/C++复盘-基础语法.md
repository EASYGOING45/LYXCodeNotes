# C++复盘-基础语法-Ⅰ

### 声明&定义

声明：不分配地址；可以多个地方声明

定义：分配地址和存储空间；只能定义一次

extern int a：修饰的是变量的声明，此变量将在文件外/后面进行定义

### 全局变量放在头文件还是源文件？

- 放在源文件中
- C++不允许多次定义变量，声明可以无数次；
- 如果放在头文件中，就相当于被其他文件包含多次，相当于定义了多次，就会导致编译错误

### 全局变量和局部变量有何区别？操作系统和编译器怎么知道？

全局变量：整个程序都可以访问，程序运行结束释放，存放在全局数据段

局部变量：所在模块可以访问，函数调用完毕后局部变量消失，内存释放，分配在堆栈

操作系统和编译器根据内存分配的位置进行判断

### 参数传递的方式

值传递&引用传递&指针传递

值传递：函数内部修改不会影响参数真实的值

指针传递：传入指向实参地址的指针

引用传递：实参的别名，间接寻址找到变量

### 指针和引用

|                                | 指针                   | 引用                 |
| ------------------------------ | ---------------------- | -------------------- |
|                                | 拥有自己的空间         | 只是一个别名         |
| sizeof大小                     | 4                      | 被引用对象的大小     |
| 参数传递                       | 必须解引用才能操作对象 | 直接可以修改         |
| const                          | 有const指针            | 没有const引用        |
|                                | 可以指向别的对象       | 不能被改变           |
|                                | 多级指针               | 只有一级             |
| 返回动态内容分配的对象或者内存 | 必须用指针             | 引用可能引起内存泄漏 |

### 为什么要有引用？

因为引用和值有一样的语义，而指针不是

不存在空引用，必须初始化，保证值不变，保证编译器更加安全

加减号、赋值操作符，作用在引用上会触发对象的操作符重载，但作用在指针上不会

### 指针和句柄

指针：指向系统中物理内存的地址

句柄：一种指向指针的指针，Windows用句柄标记系统资源，隐藏系统的信息

### 数组和指针

相同：作为形参的时候，传入的都是数组的首地址

地址是否可变：数组体现出指针常量的特性，不能对首地址进行修改，指针指向的地址则可以变化

大小：sizeof数组得到的是整个数组的大小，sizeof指针得到的是指针本身的大小

指针比数组更加灵活

### 数组中a和&a有什么区别

```C++
int a[10];
int (*p)[10]=&a;

a是数组名，也是数组元素首地址
a+1表示地址+1，也表示a[1]的地址
*(a+1)=a[1]
    
&a是数组的指针，类型为int(*)[10](数组指针)
&a+1 表示数组首地址加上整个数组的偏移，表示a尾元素再下一个元素的地址
```

### 指针相关

- 常量指针和指针常量

  - 常量指针
    - 常量是指针吗？ ×
    - 不能用这个指针修改变量值，原来的声明可以修改值
    - const* 常量 指针
    - const int *p
    - int const *p
  - 指针常量
    - 指针是常量？ √
    - 所以指针指向的东西不能改变；指向哪个变量就是哪个，不能修改
      - `* const 指针 常量`
      - `int *const p`

- 悬挂指针和野指针

  - 悬挂指针：指针所指对象已经被释放
  - 野指针：未初始化的指针
  - 如何避免野指针？①初始化时指向NULL ②释放之后指向NULL

- 函数指针

  ```C++
  int(*)()：函数指针
  int()：函数原型
  //函数指针
  int (*fp)(int , int) = f;
  (*fp)(a, b);
  //返回值为指针
  int * fp(int , int
  ```

- 函数指针的好处

  - 涉及另一个函数，但是函数名未定，要当成函数指针

- 函数指针的使用场景

  - 函数回调
  - 虚函数指针

- ((void()())0)()什么含义？

  - `void (*)()`:函数指针，无参数返回值为空*
  - `(void(*)())0`:把0强制转换成函数指针类型，一个函数存在首地址为0的一块区域内
  - `(void()())0`:取0地址开始的一段内存中的内容，内容也就是函数的内容
  -  `(void()()) 0 )()`：函数调用

