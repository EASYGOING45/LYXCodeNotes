# 面经预热Day14(数据库专题)

## 1、一条SQL查询语句是如何执行的？

1. 连接器：连接器负责跟客户端建立连接、获取权限、维持和管理连接
2. 查询缓存：MySQL拿到一个查询请求后，会先到查询缓存看看，之前是不是执行过这条语句。之前执行过的语句及其结果可能会以key-value对的形式，被直接缓存在内存中
3. 分析器：你输入的是由多个字符串和空格组成的一条SQL语句，MySQL需要识别出里面的字符串分别是什么，代表什么
4. 优化器：优化器是在表里面有多个索引的时候，决定使用哪个索引；或者在一个语句有多表关联（join）的时候，决定各个表的连接顺序
5. 执行器：MySQL通过分析器知道了你要做什么，通过优化器知道了该怎么做，于是就进入了执行器阶段，开始执行语句

![image-20230920194540096](https://happygoing.oss-cn-beijing.aliyuncs.com/img/image-20230920194540096.png)

## 2、说一说事务隔离级别

当数据库上有多个事务同时执行的时候，就可能出现 脏读（dirty read）、不可重复读（non-repeatable read）、幻读（phantom read）的问题，为了解决这些问题，就有了“隔离级别”的概念。

SQL标准的事务隔离级别包括：读未提交（read uncommitted）、读提交（read committed）、可重复读（repeatable read）和串行化（serializable）

- 读未提交是指，一个事务还没提交时，它做的变更就能被别的事务看到
- 被提交是指，一个事务提交之后，它做的变更才会被其他事务看到
- 可重复读是指，一个事务执行过程中看到的数据，总是跟这个事务在启动时看到的数据是一致的，当然在可重复读隔离级别下，未提交变更对其他事务也是不可见的
- 串行化，顾名思义是对于同一行记录，“写”会加“写锁”，“读”会加“读锁”，当出现读写锁冲突的时候，后访问的事务必须等前一个事务执行完成，才能继续执行

## 3、事务的四大特性有哪些？

ACID 事务四大特性

1.原子性:事务是不可分割的最小工作单元，一个事务对应一个完整的业务。一个事务的所有操作要么全部完成要么全部没完成，不能停留在中间状态，如果事务执行过程中出现错误就会被回滚到原来的状态

2.一致性: 一个事务执行之前和执行之后都必须处于一致性状态。比如a与b账户共有1000块，两人之间转账之后无论成功还是失败，它们的账户总和还是1000。

3.隔离性: 允许多个并发的事务同时对数据修改和读取，执行互不干扰，防止多个事务并发执行由于交叉执行造成数据不一致的情况。和隔离的级别有关,例如read和commitied,一个事务只能读到已经提交的修改。

4.持久性: 一个事务一旦被提交了，那么对数据库中的数据的改变就是永久性的，即便是在数据库系统遇到故障的情况下也不会丢失提交事务的操作。